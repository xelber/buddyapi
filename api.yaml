swagger: '2.0'
info:
  description: Buddy API
  version: "1.2.0"
  title: Buddy API
  contact:
    email: hiranmilinda@gmail.com

tags:
  - name: admins
  description: Secured Admin-only calls
  - name: developers
  description: Operations available to regular developers
schemes:
  - https
consumes: 
  - application/json
produces:
  - application/json
parameters:
  AuthorizationHeader:
    in: header
    name: Authorization
    description: "\"Authorization: <API Key>\" API System Key identifies the Service making this specific request."
    required: true
    type: string
    
  RequestIdHeader:
    in: header
    name: X-Request-ID
    description: SessionUUID generated by the Initiating Consumer System per request – allows end-end tracking & auditing
    required: true
    type: string
  
  APIVersionHeader:
    in: header
    name: X-API-Version
    description: Specific API version that the Initiating Consumer System is using as its integration definition
    required: true
    type: string
  
  ContentTypeHeader:
    in: header
    name: Content-Type
    description: application/json – permanent value stating that associated request payload is being passed in JSON
    required: true
    type: string
  
  AcceptHeader:
    in: header
    name: Accept
    description: application/json – permanent value stating that representation response needs to be JSON
    required: true
    type: string
  
responses:
  UnauthorizedResponse: Unauthorized
  
  
paths:
  /v1/soh/inventory/search:
    post:
      consumes: 
      - application/json
      produces:
      - application/json
      tags:
      - developers
      summary: Get stock information for multiple item
      operationId: soh
      description: Get the current stock in hand by passing the sku and department ID. Multiples are allowd.
      parameters:
      - $ref: '#/parameters/AuthorizationHeader'
      - $ref: '#/parameters/RequestIdHeader'
      - $ref: '#/parameters/APIVersionHeader'
      - $ref: '#/parameters/ContentTypeHeader'
      - $ref: '#/parameters/AcceptHeader'
      - in: body
        name: request
        description: Application user details used to login to the application
        required: true
        schema:
            $ref: '#/definitions/SOHRequest'
      responses:
        200:
          description: SKU found
          schema:
            $ref: '#/definitions/SOHResponse'
              
        400:
          description: Bad input parameter
        404:
          description: Item not found
        401:
          description: Unauthorized
        406:
          description: Incorrect accept header - only application/json at present
        415:
          description: Incorrect content type header - only application/json at present
  
  /v1/pricematch/competitor/search:
    post:
      consumes: 
      - application/json
      produces:
      - application/json
      tags:
      - developers
      summary: Get competitor details for price match
      operationId: pricematch
      description: |
        Get competitor details for price match
      parameters:
      - $ref: '#/parameters/AuthorizationHeader'
      - $ref: '#/parameters/RequestIdHeader'
      - $ref: '#/parameters/APIVersionHeader'
      - $ref: '#/parameters/ContentTypeHeader'
      - $ref: '#/parameters/AcceptHeader'
      - in: body
        name: request
        description: Price Match Request
        required: true
        schema:
            $ref: '#/definitions/PriceMatchRequest'
      responses:
        200:
          description: List of competitors matching the context
          schema:
            $ref: '#/definitions/PriceMatchResponse'
              
        400:
          description: Bad input parameter
        404:
          description: Item not found
        401:
          description: Unauthorized
        406:
          description: Incorrect accept header - only application/json at present
        415:
          description: Incorrect content type header - only application/json at present
  
  /v1/product/search/{query}:
    get:
      consumes: 
      - application/json
      produces:
      - application/json
      tags:
      - developers
      summary: Search Products
      operationId: product_search
      description: |
        Search through products. Query can be SKU, GTIN or product title
      parameters:
      - $ref: '#/parameters/AuthorizationHeader'
      - $ref: '#/parameters/RequestIdHeader'
      - $ref: '#/parameters/APIVersionHeader'
      - $ref: '#/parameters/AcceptHeader'
      - in: path
        name: query
        description: Search Query. Needs to be URL encoded. Can be search by name, SKU or GTIN
        required: true
        type: string
        
      responses:
        200:
          description: Product Search Results
          schema:
            $ref: '#/definitions/ProductSearchResponse'
              
        400:
          description: Bad input parameter
        401:
          description: Unauthorized
        406:
          description: Incorrect accept header - only application/json at present
  /v1/product/{buddy-product-key}:
    get:
      summary: Get product details
      operationId: product_info
      description: |
        Get product details for multiple products
      parameters:
      - $ref: '#/parameters/AuthorizationHeader'
      - $ref: '#/parameters/RequestIdHeader'
      - $ref: '#/parameters/APIVersionHeader'
      - $ref: '#/parameters/ContentTypeHeader'
      - $ref: '#/parameters/AcceptHeader'
      - in: path
        name: buddy-product-key
        description: Unique product identifier
        required: true
        type: string
      responses:
        200:
          description: Return product info
          schema:
            $ref: '#/definitions/ProductInfoResponse'
        400:
          description: Bad input parameter
        401:
          description: Unauthorized
        406:
          description: Incorrect accept header - only application/json at present
  
  /v1/cart:
    post:
      consumes: 
      - application/json
      produces:
      - application/json
      tags:
      - developers
      summary: Initiate a cart.
      operationId: cart-init
      description: |
        Create a cart and return a cart ID. Cart owner extracted from Authorization header.
      parameters:
      - $ref: '#/parameters/AuthorizationHeader'
      - $ref: '#/parameters/RequestIdHeader'
      - $ref: '#/parameters/APIVersionHeader'
      - $ref: '#/parameters/ContentTypeHeader'
      - $ref: '#/parameters/AcceptHeader'
      - in: body
        name: request
        description: Application user details used to login to the application
        required: true
        schema:
            $ref: '#/definitions/SOHRequest'
      responses:
        200:
          description: SKU found
          schema:
            $ref: '#/definitions/SOHResponse'
              
        400:
          description: Bad input parameter
        404:
          description: Item not found
        401:
          $ref : '#responses/UnauthorizedResponsed'
        406:
          description: Incorrect accept header - only application/json at present
        415:
          description: Incorrect content type header - only application/json at present
  
  
definitions:
  
  ResponseHeader:
    type: object
    required:
    - RequestId
    - HttpResponseCode
    - Messages
    properties:
      RequestId:
        type: string
        example: "6016cf28-c095-4c9a-a713-6df65d30e772"
      HttpResponseCode:
        type: integer
        example: 200
      Messages:
        type: string
        example: "OK"
  
  SOHRequest:
    type: object
    required:
    - Items
    properties:
      Items:
        type: array
        items:
          $ref: '#/definitions/SOHRequestedItem'
  
  SOHRequestedItem:
    type: object
    required:
    - Sku
    - DepartmentId
    properties:
      Sku:
        type: string
        example: "48942893"
      DepartmentId:
        type: string
        example: "060"
        
  SOHResponse:
    type: object
    required:
    - ResponseHeader
    - InventoryItems
    properties:
      ResponseHeader:
        $ref: '#/definitions/ResponseHeader'
      InventoryItems:
        type: array
        items:
          $ref: '#/definitions/InventoryItem'
  
  InventoryItem:
    type: object
    required:
    - Sku
    - DepartmentId
    - AvailableSoh
    - StockOnHand
    - ReservedCount
    - OnOrderCount
    - FrozenCount
    - OnlineOrderedCount
    - LastUpdate
    - SellPrice
    properties:
      Sku:
        type: string
        example: "X0390"
      DepartmentId:
        type: string
        example: "060"
      StockOnHand:
        type: number
        example: 10
      ReservedCount:
        type: number
        example: 2
      OnOrderCount:
        type: number
        example: 20
      FrozenCount:
        type: number
        example: 1
      OnlineOrderedCount:
        type: number
        example: 1
      AvailableSoh:
        type: number
        example: 1
      LastUpdate:
        type: string
        example: "2017-02-20T09:48:54.000+11:00"
      SellPrice:
        type: number
        example: 299.96
  
  PriceMatchRequest:
    type: object
    required:
    - Context
    properties:
      Context:
        $ref: '#/definitions/PriceMatchContext'
  
  PriceMatchContext:
    type: object
    required:
    - StoreId
    - DepartmentId
    - State
    - Postcode
    - Brand
    properties:
      StoreId:
        type: string
        example: "0601"
      DepartmentId:
        type: string
        example: "062"
      State:
        type: string
        example: "NSW"
      Postcode:
        type: string
        example: "2140"
      Brand:
        type: string
        example: "Harvey Norman"
    
  PriceMatchResponse:
    type: object
    required:
    - ResponseHeader
    - Competitor
    properties:
      ResponseHeader:
        $ref: '#/definitions/ResponseHeader'
      Competitor:
        type: array
        items:
          $ref: '#/definitions/PriceMatchCompetitor'
  
  PriceMatchCompetitor:
    type: object
    required:
    - Id
    - Name
    - Description
    - SearchUrl
    - LogoUrl
    - QueryBy
    properties:
      Id:
        type: integer
        example: 1
      Name:
        type: string
        example: "jbhifi"
      Description:
        type: string
        example: "jbhifi"
      SearchUrl:
        type: string
        example: "https://www.jbhifi.com.au/?q={QUERY}&"
      LogoUrl:
        type: string
        example: "https://www.jbhifi.com.au/img/img_logo-bp3.png"
      QueryBy:
        type: string
        example: "SKU"
        
  ProductSearchResponse:
    type: object
    required:
    - ResponseHeader
    - SearchResults
    properties:
      ResponseHeader:
        $ref: '#/definitions/ResponseHeader'
      SearchResults:
        type: array
        items:
          $ref: '#/definitions/ProductSearchResult'
  
  ProductSearchResult:
    type: object
    required:
    - ResultCount
    - SearchResult
    properties:
      ResultCount:
        type: integer
        example: 8
      SearchResult:
        type: array
        items:
          $ref: '#/definitions/ProductSearchResultItem'
  
  ProductSearchResultItem:
    type: object
    required:
    - BuddyProductKey
    - Sku
    - DepartmentId
    - Name
    - SellPrice
    properties:
      BuddyProductKey:
        type: string
        example: "060-X0390"
        description : "Uniquely identify product for buddy. Composite key of department id and sku"
      Sku:
        type: string
        example: "X0390"
      DepartmentId:
        type: string
        example: "060"
      Name:
        type: string
        example: "HP Spectre X360 13-AC001TU 2-in-1 13\" Laptop - Rose Gold"
        description : "SAP Name"
      SellPrice:
        type: number
        example: 299.96
      OnlineName:
        type: string
        example: "HP Spectre X360 13-AC001TU 2-in-1 13\" Laptop - Rose Gold"
        description : "Magento name. Optional."

  
  ProductInfoResponse:
    type: object
    required:
    - ResponseHeader
    - Product
    properties:
      ResponseHeader:
        $ref: '#/definitions/ResponseHeader'
      Product:
        $ref: '#/definitions/ProductItemInfo'
  
  ProductItemInfo:
    description: "Represent an object with product info. All basic data are derived from SAP data unless prefixed with 'Online' e.g. OnlineName. ExtendedProductData will contain all the online attributes with key value and label."
    type: object
    required:
    - BuddyProductKey
    - Sku
    - DepartmentId
    - GTIN
    - Name
    - Name2
    - Category
    - Group
    - Class
    - SupplierId
    - SellPrice
    - CostPrice
    - Warranty
    - Brand
    - Model
    
    properties:
      BuddyProductKey:
        type: string
        example: "060-X0390"
        description : "Uniquely identify product for buddy. Composite key of department id and sku"
      Sku:
        type: string
        example: "X0390"
      GTIN:
        type: string
        example: "8208238032809"
      DepartmentId:
        type: string
        example: "060"
      Name:
        type: string
        example: "X360 13-AC001TU 2-in-1 13"
      Name2:
        type: string
        example: "HP Spectre X360 13-AC001TU 2-in-1 13\" Laptop - Rose Gold"
      Category:
        type: string
        example: "NBK"
      Group:
        type: string
        example: "HAR"
      Class:
        type: string
        example: "C17"
      SupplierId:
        type: string
        example: "300161"
      SellPrice:
        type: number
        example: 299.96
      CostPrice:
        type: number
        example: 299.96
      Warranty:
        type: string
        example: "12 Months"
      Brand:
        type: string
        example: "HP"
      Model:
        type: string
        example: "HP SPECTRE X360 13-W"
      OnlineName:
        type: string
        example: "HP Spectre X360 13-AC001TU 2-in-1 13\" Laptop - Rose Gold"
      OnlineImageUrl:
        type: string
        example: "https://doxz7msmg7sxx.cloudfront.net/media/catalog/product/cache/21/image/992x558/9df78eab33525d08d6e5fb8d27136e95/s/p/spectre_x360_1.jpg"
      OnlineThumbnailUrl:
        type: string
        example: "https://doxz7msmg7sxx.cloudfront.net/media/catalog/product/cache/21/image/992x558/9df78eab33525d08d6e5fb8d27136e95/s/p/spectre_x360_1.jpg"
      ExtendedProductData:
        type: array
        items:
          $ref: '#/definitions/ExtendedProductData'
  
  ExtendedProductData:
    type: object
    required:
    - Key
    - Label
    - Value
    properties:
      Key:
        type: string
        example: "def_cartridge_number"
      Label:
        type: string
        example: "Cartridge Number"
      Value:
        type: string
        example: "X94384J"
# Added by API Auto Mocking Plugin
#host: virtserver.swaggerhub.com
host: buddypoc.azure-api.net
basePath: /